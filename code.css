:root {
  --primary-color: #007bff;
  --primary-color-darker: #0056b3;
  --primary-color-hover: #0069d9;
  --rgb-primary-color: 0, 123, 255; /* For use with rgba */
  --text-on-primary: #ffffff;

  --background-color: #f4f4f4;
  --text-color: #333;
  --card-background: #ffffff;
  --border-color: #eee;
  --shadow-color: rgba(0,0,0,0.1);
  --input-border-color: #ccc;
  --popup-background: #ffffff;

  --sidebar-background: #222;
  --sidebar-text-color: #b1b1b1;
  --sidebar-text-hover-color: #f1f1f1;
  --sidebar-active-bg: #333;

  --header-background: var(--primary-color);
  --header-text-color: var(--text-on-primary);

  --tab-button-background: var(--primary-color);
  --tab-button-text-color: var(--text-on-primary);
  --tab-button-active-background: var(--primary-color-darker);
  --tab-button-hover-background: var(--primary-color-hover);

  --action-btn-edit-bg: #ffc107;
  --action-btn-edit-text: #212529;
  --action-btn-delete-bg: #dc3545;
  --action-btn-delete-text: white;

  --fab-bg-color: #dc3545; /* FAB specific - kept distinct */
  --fab-hover-bg-color: #c82333;

  --progress-fill-good: #28a745;
  --progress-fill-warn: #ffc107;
  --progress-fill-bad: #dc3545;

  --amount-income-color: #28a745;
  --amount-expense-color: #dc3545;

  --link-color: var(--primary-color);
  --link-hover-color: var(--primary-color-darker);

  --h2-color: var(--primary-color-darker);
  --h3-color: var(--primary-color-hover);
}

body {
  font-family: Arial, sans-serif; margin: 0;
  background: var(--background-color);
  color: var(--text-color);
  padding-top: 60px;
  padding-bottom: 70px;
  transition: background-color 0.3s, color 0.3s;
}

/* Header */
header {
  background-color: var(--header-background);
  color: var(--header-text-color);
  padding: 0 1rem;
  height: 60px;
  display: flex; align-items: center;
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 1050;
  box-shadow: 0 2px 4px var(--shadow-color);
}
.hamburger-button {
  background: none; border: none;
  color: var(--header-text-color);
  cursor: pointer;
  padding: 0.8rem; margin-right: 0.5rem; margin-left: -0.8rem;
}
.hamburger-button svg { display: block; width: 28px; height: 28px; fill: currentColor; }
.app-title { font-size: 1.3rem; font-weight: bold; }

/* Sidebar Navigation */
.sidebar {
  height: 100%; width: 0;
  position: fixed; z-index: 1100;
  top: 0; left: 0;
  background-color: var(--sidebar-background);
  overflow-x: hidden;
  transition: 0.3s ease-out;
  padding-top: 70px;
  box-shadow: 2px 0 5px rgba(0,0,0,0.2);
}
.sidebar .menu-tab-button {
  padding: 12px 15px 12px 20px;
  text-decoration: none; font-size: 1.1rem;
  color: var(--sidebar-text-color);
  display: block; transition: 0.2s;
  width: 100%; text-align: left;
  background: none; border: none; cursor: pointer;
}
.sidebar .menu-tab-button:hover, .sidebar .menu-tab-button.active {
  color: var(--sidebar-text-hover-color);
  background-color: var(--sidebar-active-bg);
}
.sidebar .closebtn {
  position: absolute; top: 15px; right: 15px;
  color: #818181;
  background: none; border: none; cursor: pointer;
  padding: 8px;
  line-height: 0;
}
.sidebar .closebtn svg { width: 24px; height: 24px; display: block; }
.sidebar-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.5);
  z-index: 1040;
  display: none;
}

/* Bottom Tabs */
.tabs {
  display: flex;
  background: var(--tab-button-background);
  position: fixed; bottom: 0; left: 0; width: 100%;
  z-index: 1000; box-shadow: 0 -2px 5px var(--shadow-color);
  -webkit-overflow-scrolling: touch;
}
.tab-button {
  flex-grow: 1; flex-shrink: 1; flex-basis: 0;
  padding: 0.6rem 0.2rem;
  color: var(--tab-button-text-color);
  text-align: center;
  cursor: pointer; border: none;
  background: var(--tab-button-background);
  white-space: nowrap;
  transition: background-color 0.3s ease;
  border-right: 1px solid rgba(255,255,255,0.15);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  overflow: hidden; text-overflow: ellipsis;
}
.tab-button svg { width: 20px; height: 20px; margin-bottom: 2px; fill: currentColor; }
.tab-button span { font-size: 0.6rem; display: block; line-height: 1.1; margin-top: 1px;}
.tab-button:last-child { border-right: none; }
.tab-button.active { background: var(--tab-button-active-background); }
.tab-button:hover:not(.active) { background: var(--tab-button-hover-background); }

.tab-content { display: none; padding: 1.5rem; }
.tab-content.active { display: block; }

/* Month Navigator */
.month-navigator {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    margin-bottom: 1rem;
    background-color: var(--card-background);
    border-radius: 6px;
    box-shadow: 0 1px 3px var(--shadow-color);
}
.month-nav-btn {
    background-color: var(--primary-color);
    color: var(--text-on-primary);
    border: none;
    padding: 0.5rem 0.8rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background-color 0.2s;
}
.month-nav-btn:hover {
    background-color: var(--primary-color-hover);
}
.month-nav-btn:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}
body.dark-mode .month-nav-btn:disabled {
    background-color: #555;
    color: #888;
}
.current-month-display {
    font-weight: bold;
    font-size: 1.1rem;
    color: var(--primary-color-darker);
}
body.dark-mode .current-month-display {
    color: var(--primary-color-hover);
}


h2 { margin-top: 0; margin-bottom: 1.5rem; color: var(--h2-color); }
.popup-form h3 { margin-top: 0; margin-bottom: 1.5rem; text-align: center; }
h3:not(.popup-form h3) { margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--h3-color); }
h4 { font-size: 0.95rem; color: #555; margin-top: 1.2rem; margin-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.3rem;}

.table-responsive-wrapper {
  overflow-x: auto; margin-top: 1rem;
  background: var(--card-background);
  border-radius: 8px; box-shadow: 0 2px 4px var(--shadow-color);
}
.table-responsive-wrapper.initially-hidden { display: none; }
.no-items-message { text-align:center; margin-top: 2rem; color: #777; }

table { width: 100%; border-collapse: collapse; }
th, td { padding: 0.8rem 1rem; text-align: left; border-bottom: 1px solid var(--border-color); font-size: 0.9rem; }
th { background-color: var(--primary-color); color: var(--text-on-primary); font-weight: 600; }
tr:last-child td { border-bottom: none; }
 @media (max-width: 480px) {
    th, td { padding: 0.5rem; font-size: 0.8rem; }
}
.action-btn {
    padding: 0.3rem 0.5rem;
    font-size: 0.75rem;
    margin-right: 0.3rem;
    cursor: pointer;
    border: 1px solid transparent;
    border-radius: 4px;
}
.edit-btn { background-color: var(--action-btn-edit-bg); color: var(--action-btn-edit-text); border-color: var(--action-btn-edit-bg); }
.delete-btn { background-color: var(--action-btn-delete-bg); color: var(--action-btn-delete-text); border-color: var(--action-btn-delete-bg); }


/* Dashboard Specific Styles */
.dashboard-box {
  background: var(--card-background);
  padding: 1.2rem; margin-bottom: 1rem;
  border-radius: 8px; box-shadow: 0 2px 5px var(--shadow-color);
}
.dashboard-summary-grid {
    display: flex;
    gap: 0.8rem;
    margin-bottom: 1.5rem;
}
.summary-item {
    flex: 1 1 0;
    min-width: 90px;
    padding: 0.8rem;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 90px;
    box-sizing: border-box;
}
.summary-item .summary-value {
    font-size: 1.6rem;
    font-weight: bold;
    color: var(--primary-color-darker);
    display: block;
    margin-bottom: 0.15rem;
}
.summary-item .summary-value .amount-income,
span#totalIncomeDisplay.amount-income {
    color: var(--amount-income-color) !important;
}
.summary-item .summary-value .amount-expense,
span#totalExpenses.amount-expense {
    color: var(--amount-expense-color) !important;
}

.summary-item .summary-label {
    font-size: 0.70rem;
    color: #555;
    display: block;
    white-space: normal;
}
 #monthlyChart { max-width: 100%; }


.progress-bar {
  height: 20px; background: #e9ecef; border-radius: 5px;
  overflow: hidden; margin-top: 0.5rem;
}
.progress-fill {
  height: 100%; background: var(--progress-fill-good); width: 0%;
  transition: width 0.5s ease-in-out, background-color 0.3s ease;
}
.hidden { display: none !important; }

/* Popup Form Overlay & Styling */
.form-popup-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.6); z-index: 1070;
    display: none; align-items: center; justify-content: center;
}
.popup-form {
    background: var(--popup-background);
    padding: 2rem; padding-top: 2.5rem;
    border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    width: 90%; max-width: 500px; position: relative;
    max-height: 90vh; overflow-y: auto;
}
.popup-form input, .popup-form select, .popup-form button[type="submit"] {
    width: 100%; padding: 0.8rem; margin-bottom: 1rem;
    border-radius: 5px; border: 1px solid var(--input-border-color);
    box-sizing: border-box; font-size: 0.95rem;
}
.popup-form button[type="submit"] {
    background-color: var(--primary-color);
    color: var(--text-on-primary);
    cursor: pointer;
    border: none; transition: background-color 0.3s ease;
}
.popup-form button[type="submit"]:hover { background-color: var(--primary-color-darker); }

.popup-close-btn {
    position: absolute; top: 10px; right: 10px;
    background: none; border: none; font-size: 1.5rem;
    color: #888; cursor: pointer; padding: 5px; line-height: 1;
}
.popup-close-btn:hover { color: #333; }

#fabActionSelectPopup { }
.fab-action-btn {
    display: block; width: 100%; padding: 0.8rem; margin-bottom: 0.8rem;
    font-size: 1rem;
    background-color: var(--primary-color);
    color: var(--text-on-primary);
    border: none; border-radius: 5px; cursor: pointer;
    transition: background-color 0.2s ease;
}
.fab-action-btn:hover { background-color: var(--primary-color-darker); }
.fab-action-btn.cancel { background-color: #6c757d; }
.fab-action-btn.cancel:hover { background-color: #545b62; }

/* Loan Card Styling */
#loanCardContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
}
.loan-card {
    background-color: var(--card-background);
    border-radius: 8px;
    box-shadow: 0 2px 5px var(--shadow-color);
    padding: 1rem;
    width: calc(50% - 1rem);
    min-width: 280px;
    box-sizing: border-box;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}
.loan-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}
.loan-card h4 {
    margin-top: 0;
    margin-bottom: 0.5rem;
    color: var(--primary-color-darker);
    font-size: 1.1rem;
    cursor: pointer;
}
.loan-card p { margin: 0.3rem 0; font-size: 0.9rem; color: #555; cursor: pointer; }
.loan-card p strong { color: #333; }
.loan-card .loan-remaining { font-weight: bold; color: var(--amount-expense-color); font-size: 1rem; }
.loan-card .loan-paid { color: var(--amount-income-color); }
.loan-card .action-buttons-container { margin-top: 0.75rem; text-align: right;}


/* Loan Detail Popup Content Styling */
#loanDetailPopupContent p { margin: 0.6rem 0; font-size: 1rem; line-height: 1.5; }
#loanDetailPopupContent strong { display: inline-block; min-width: 140px; color: #333; }


/* Floating Action Button (FAB) */
.fab-button {
  position: fixed; bottom: 85px; right: 20px;
  width: 56px; height: 56px; border-radius: 50%;
  background-color: var(--fab-bg-color); color: white; border: none;
  box-shadow: 0 4px 10px rgba(0,0,0,0.25); cursor: pointer;
  z-index: 1030;
  transition: background-color 0.3s ease, transform 0.2s ease, opacity 0.3s ease, visibility 0.3s ease;
  display: flex; align-items: center; justify-content: center;
  opacity: 1; visibility: visible;
}
.fab-button.hidden-fab { opacity: 0; visibility: hidden; pointer-events: none; }
.fab-button:hover { background-color: var(--fab-hover-bg-color); transform: scale(1.05); }
.fab-button svg { fill: white; width: 28px; height: 28px; }

/* Recent Activity Section */
.recent-activity-filters {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}
.activity-filter-btn {
    padding: 0.5rem 1rem;
    border: 1px solid var(--primary-color);
    background-color: var(--card-background);
    color: var(--primary-color);
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: background-color 0.2s, color 0.2s;
}
.activity-filter-btn:hover {
    background-color: rgba(var(--rgb-primary-color), 0.1);
}
.activity-filter-btn.active {
    background-color: var(--primary-color);
    color: var(--text-on-primary);
}
.recent-transactions-list {
    max-height: 300px;
    overflow-y: auto;
    padding-right: 5px;
}
.recent-transaction-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.7rem 0.2rem;
    border-bottom: 1px solid var(--border-color);
    font-size: 0.9rem;
}
.recent-transaction-item:last-child { border-bottom: none; }
.recent-transaction-info { display: flex; flex-direction: column; flex-grow: 1; margin-right: 0.5rem; }
.recent-transaction-type { font-size: 0.65rem; color: #666; text-transform: uppercase; font-weight: 500; margin-bottom: 2px; }
.recent-transaction-date { font-size: 0.75rem; color: #888; margin-bottom: 2px; }
.recent-transaction-desc { color: #333; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
.recent-transaction-amount { font-weight: bold; white-space: nowrap; }
.amount-expense { color: var(--amount-expense-color); }
.amount-income { color: var(--amount-income-color); }
.no-recent-activity-message { text-align: center; color: #777; padding: 1rem 0; }

/* Settings Page Styles */
.settings-section {
  background: var(--card-background);
  padding: 1.2rem;
  margin-bottom: 1.5rem;
  border-radius: 8px;
  box-shadow: 0 2px 5px var(--shadow-color);
}
.settings-section h3 {
  margin-top: 0;
  margin-bottom: 1rem;
  color: var(--h3-color);
  border-bottom: 1px solid var(--border-color);
  padding-bottom: 0.5rem;
}
.setting-item {
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}
.setting-item label {
  margin-right: 1rem;
  font-weight: 500;
  min-width: 120px;
  margin-bottom: 0.5rem;
}
#themeColorOptions {
  display: flex;
  gap: 0.5rem;
  margin-right: 1rem;
  margin-bottom: 0.5rem;
}
.color-swatch {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid var(--border-color);
  transition: transform 0.2s, border-color 0.2s;
}
.color-swatch:hover {
  transform: scale(1.1);
}
.color-swatch.active-color {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 2px var(--primary-color);
}
#customThemeColorPicker {
    width: 40px;
    height: 30px;
    padding: 2px;
    border-radius: 4px;
    border: 1px solid var(--input-border-color);
    cursor: pointer;
    background-color: transparent;
}
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 28px;
  background-color: #ccc;
  border-radius: 28px;
  cursor: pointer;
  transition: background-color 0.3s;
  border: none;
  padding: 0;
}
.toggle-switch .toggle-slider {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: transform 0.3s;
}
.toggle-switch.active {
  background-color: var(--primary-color);
}
.toggle-switch.active .toggle-slider {
  transform: translateX(22px);
}
.settings-action-btn {
  padding: 0.6rem 1rem;
  font-size: 0.9rem;
  background-color: var(--primary-color);
  color: var(--text-on-primary);
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  margin-right: 1rem;
  margin-bottom: 0.5rem;
}
.settings-action-btn:hover {
  background-color: var(--primary-color-darker);
}
.settings-action-btn.danger {
  background-color: var(--action-btn-delete-bg);
  color: var(--action-btn-delete-text);
}
.settings-action-btn.danger:hover {
  background-color: #c82333;
}
.setting-description {
    font-size: 0.8rem;
    color: #666;
    margin-top: 0.3rem;
    flex-basis: 100%;
}


/* Dark Mode Specific Styles */
body.dark-mode {
  --background-color: #121212;
  --text-color: #e0e0e0;
  --card-background: #1e1e1e;
  --border-color: #333;
  --shadow-color: rgba(255,255,255,0.05);
  --input-border-color: #444;
  --popup-background: #2a2a2a;

  --sidebar-background: #1a1a1a;
  --sidebar-text-color: #a0a0a0;
  --sidebar-text-hover-color: #f0f0f0;
  --sidebar-active-bg: #2c2c2c;

  --h2-color: var(--primary-color-hover);
  --h3-color: var(--primary-color);

  --link-color: var(--primary-color-hover);
  --link-hover-color: var(--primary-color);
}
body.dark-mode .tab-button { border-right: 1px solid rgba(0,0,0,0.2); }
body.dark-mode .tab-button:last-child { border-right: none; }
body.dark-mode h4 { color: #bbb; border-bottom: 1px solid var(--border-color); }
body.dark-mode .summary-item .summary-label { color: #bbb; }
body.dark-mode .progress-bar { background: #333; }
body.dark-mode .popup-close-btn { color: #aaa; }
body.dark-mode .popup-close-btn:hover { color: #eee; }
body.dark-mode .fab-action-btn.cancel { background-color: #555; }
body.dark-mode .fab-action-btn.cancel:hover { background-color: #444; }
body.dark-mode .loan-card p { color: #bbb; }
body.dark-mode .loan-card p strong { color: #ddd; }
body.dark-mode #loanDetailPopupContent strong { color: #ddd; }
body.dark-mode .activity-filter-btn {
  border: 1px solid var(--primary-color);
  background-color: var(--card-background);
  color: var(--primary-color);
}
body.dark-mode .activity-filter-btn:hover {
  background-color: rgba(var(--rgb-primary-color), 0.2);
}
body.dark-mode .activity-filter-btn.active {
  background-color: var(--primary-color);
  color: var(--text-on-primary);
}
body.dark-mode .recent-transaction-type { color: #aaa; }
body.dark-mode .recent-transaction-date { color: #999; }
body.dark-mode .recent-transaction-desc { color: #ddd; }
body.dark-mode .no-items-message { color: #888; }
body.dark-mode .no-recent-activity-message { color: #888; }
body.dark-mode .popup-form input, body.dark-mode .popup-form select {
    background-color: #2c2c2c;
    color: var(--text-color);
    border: 1px solid var(--input-border-color);
}
body.dark-mode .popup-form input::placeholder { color: #777; }
 body.dark-mode .popup-form select option { background-color: #2c2c2c; color: var(--text-color); }
body.dark-mode .setting-description { color: #aaa; }
body.dark-mode .color-swatch { border-color: #444; }
body.dark-mode .color-swatch.active-color { border-color: var(--primary-color); }
body.dark-mode #customThemeColorPicker { border: 1px solid #555; }
body.dark-mode .toggle-switch { background-color: #444; }
body.dark-mode .toggle-switch.active { background-color: var(--primary-color); }


@media (max-width: 768px) {
  body { padding-bottom: 65px; }
  .tab-content { padding: 1rem; }
  h2 { font-size: 1.5rem; margin-bottom: 1rem; }
  .popup-form { padding: 1.5rem; padding-top: 2.5rem; width: 90%;}
  .fab-button { bottom: 80px; width: 50px; height: 50px;}
  .fab-button svg { width: 24px; height: 24px; }
  .loan-card { width: calc(100% - 0.5rem); }
   .summary-item {
    flex-basis: calc(50% - 0.4rem);
  }
  .summary-item .summary-value { font-size: 1.5rem; }
  .summary-item .summary-label { font-size: 0.7rem; }
  .recent-transaction-desc { max-width: 150px; }
  .setting-item label { min-width: 100px; }
  .month-navigator { padding: 0.4rem; }
  .month-nav-btn { padding: 0.4rem 0.6rem; font-size: 0.8rem; }
  .current-month-display { font-size: 1rem; }
}
@media (max-width: 480px) {
  body { padding-bottom: 60px; }
  .tab-button svg { width: 18px; height: 18px; margin-bottom: 1px;}
  .tab-button span { font-size: 0.55rem; }
  h2 { font-size: 1.3rem; }
  .popup-form input, .popup-form select, .popup-form button[type="submit"] { font-size: 0.9rem; }
  .app-title { font-size: 1.15rem; }
  .hamburger-button svg { width: 24px; height: 24px; }
  .fab-button { bottom: 75px; width: 48px; height: 48px;}
  .fab-button svg { width: 22px; height: 22px; }
  .popup-form { padding: 1rem; padding-top: 2rem; }
  .dashboard-summary-grid { flex-wrap: wrap; }
  .summary-item { flex-basis: 100%; min-height: 80px; margin-bottom: 0.5rem; }
  .summary-item .summary-value { font-size: 1.4rem; }
  .activity-filter-btn { font-size: 0.75rem; padding: 0.4rem 0.8rem;}
  .recent-transaction-desc { max-width: 120px; }
  .setting-item { flex-direction: column; align-items: flex-start;}
  .setting-item label { margin-bottom: 0.5rem; }
  #themeColorOptions { margin-bottom: 0.8rem; }
  .month-nav-btn { padding: 0.3rem 0.5rem; font-size: 0.75rem; }
  .current-month-display { font-size: 0.9rem; }
}